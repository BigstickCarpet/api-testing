# Travis CI config
# http://docs.travis-ci.com/user/languages/javascript-with-nodejs/
# https://docs.travis-ci.com/user/customizing-the-build/
# https://docs.travis-ci.com/user/migrating-from-legacy/

dist: trusty
sudo: false
language: nodejs

addons:
  firefox: latest
  chrome: stable

before_script:
  # Setup a virtual display for browser testing
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start

script:
  - cd mocha-chai
    echo " __   __  _______  _______  __   __  _______     _     _______  __   __  _______  ___ "
    echo "|  |_|  ||       ||       ||  | |  ||   _   |  _| |_  |       ||  | |  ||   _   ||   |"
    echo "|       ||   _   ||       ||  |_|  ||  |_|  | |_   _| |       ||  |_|  ||  |_|  ||   |"
    echo "|       ||  | |  ||       ||       ||       |   |_|   |       ||       ||       ||   |"
    echo "|       ||  |_|  ||      _||       ||       |         |      _||       ||       ||   |"
    echo "| ||_|| ||       ||     |_ |   _   ||   _   |         |     |_ |   _   ||   _   ||   |"
    echo "|_|   |_||_______||_______||__| |__||__| |__|         |_______||__| |__||__| |__||___|"

  - npm install
  - npm run mocha
  - npm run karma

  - cd ../restlet
    echo " ______    _______  _______  _______  ___      _______  _______ "
    echo "|    _ |  |       ||       ||       ||   |    |       ||       |"
    echo "|   | ||  |    ___||  _____||_     _||   |    |    ___||_     _|"
    echo "|   |_||_ |   |___ | |_____   |   |  |   |    |   |___   |   |  "
    echo "|    __  ||    ___||_____  |  |   |  |   |___ |    ___|  |   |  "
    echo "|   |  | ||   |___  _____| |  |   |  |       ||   |___   |   |  "
    echo "|___|  |_||_______||_______|  |___|  |_______||_______|  |___|  "

  - cd ../postman
    echo " _______  _______  _______  _______  __   __  _______  __    _ "
    echo "|       ||       ||       ||       ||  |_|  ||   _   ||  |  | |"
    echo "|    _  ||   _   ||  _____||_     _||       ||  |_|  ||   |_| |"
    echo "|   |_| ||  | |  || |_____   |   |  |       ||       ||       |"
    echo "|    ___||  |_|  ||_____  |  |   |  |       ||       ||  _    |"
    echo "|   |    |       | _____| |  |   |  | ||_|| ||   _   || | |   |"
    echo "|___|    |_______||_______|  |___|  |_|   |_||__| |__||_|  |__|"

  - npm install --global newman
  - newman run postman-collection.json --environment postman-environment.json

  - cd ../stoplight
    echo " _______  _______  _______  _______  ___      ___   _______  __   __  _______ "
    echo "|       ||       ||       ||       ||   |    |   | |       ||  | |  ||       |"
    echo "|  _____||_     _||   _   ||    _  ||   |    |   | |    ___||  |_|  ||_     _|"
    echo "| |_____   |   |  |  | |  ||   |_| ||   |    |   | |   | __ |       |  |   |  "
    echo "|_____  |  |   |  |  |_|  ||    ___||   |___ |   | |   ||  ||       |  |   |  "
    echo " _____| |  |   |  |       ||   |    |       ||   | |   |_| ||   _   |  |   |  "
    echo "|_______|  |___|  |_______||___|    |_______||___| |_______||__| |__|  |___|  "

  - curl https://raw.githubusercontent.com/stoplightio/prism/2.x/install.sh | sh
  - prism conduct /Users/james/Code/Personal/Training/super-powered-api-testing/Stoplight/stoplight-collection.json --spec "/Users/james/Code/Personal/Training/super-powered-api-testing/Stoplight/stoplight-spec.json" --env "API_ROOT=http://localhost:8080" --env "SLUG=supercoder"
